include(../cmake/RuntimeTargetTemplate.cmake)
add_library(ompt-print-callback INTERFACE)
target_include_directories(ompt-print-callback INTERFACE ${CMAKE_CURRENT_SOURCE_DIR}/../ompt)

add_openmp_testsuite(check-libomp "Running libomp tests" ${CMAKE_CURRENT_BINARY_DIR} DEPENDS omp)
# Add target check-ompt, but make sure to not add the tests twice to check-openmp.
add_openmp_testsuite(check-ompt "Running OMPT tests" ${CMAKE_CURRENT_BINARY_DIR} EXCLUDE_FROM_CHECK_ALL DEPENDS omp)

# Configure the lit.site.cfg.in file
set(AUTO_GEN_COMMENT "## Autogenerated by libomp configuration.\n# Do not edit!")
# Override the detected openmp flag to libomp
set(OPENMP_TEST_OPENMP_FLAGS "${OPENMP_TEST_OPENMP_FLAGS} -fopenmp=libomp")
configure_file(../lit.site.cfg.in lit.site.cfg @ONLY)
