! NOTE: Assertions have been autogenerated by /home/rpenacob/llvm-mono/mlir/utils/generate-test-checks.py
! This test checks lowering of OmpSs-2 taskloop do Directive.

! RUN: bbc -fompss-2 -emit-fir %s -o - | FileCheck %s --check-prefix=FIRDialect

program task
    INTEGER :: I
    INTEGER :: J

    ! No clauses
    !$OSS TASKLOOP DO
    DO J=1,10
    END DO
    !$OSS END TASKLOOP DO

    ! if clause
    !$OSS TASKLOOP DO IF(I .EQ. 3)
    DO J=1,10
    END DO
    !$OSS END TASKLOOP DO

    ! final clause
    !$OSS TASKLOOP DO FINAL(I .EQ. 3)
    DO J=1,10
    END DO
    !$OSS END TASKLOOP DO

    ! cost clause
    !$OSS TASKLOOP DO COST(3)
    DO J=1,10
    END DO
    !$OSS END TASKLOOP DO

    ! priority clause
    !$OSS TASKLOOP DO PRIORITY(3)
    DO J=1,10
    END DO
    !$OSS END TASKLOOP DO

    ! default clause
    !$OSS TASKLOOP DO DEFAULT(SHARED)
    DO J=1,10
    END DO
    !$OSS END TASKLOOP DO

    ! private clause
    !$OSS TASKLOOP DO PRIVATE(I)
    DO J=1,10
    END DO
    !$OSS END TASKLOOP DO

    ! firstprivate clause
    !$OSS TASKLOOP DO FIRSTPRIVATE(I)
    DO J=1,10
    END DO
    !$OSS END TASKLOOP DO

    ! shared clause
    !$OSS TASKLOOP DO SHARED(I)
    DO J=1,10
    END DO
    !$OSS END TASKLOOP DO

    ! chunksize clause
    !$OSS TASKLOOP DO CHUNKSIZE(3)
    DO J=1,10
    END DO
    !$OSS END TASKLOOP DO

    ! grainsize clause
    !$OSS TASKLOOP DO GRAINSIZE(3)
    DO J=1,10
    END DO
    !$OSS END TASKLOOP DO

end program


! FIRDialect-LABEL:   func.func @_QQmain() attributes {fir.bindc_name = "task"} {
! FIRDialect:           %[[VAL_0:[-0-9A-Za-z._]+]] = fir.alloca i32 {bindc_name = "i", uniq_name = "_QFEi"}
! FIRDialect:           %[[VAL_1:[-0-9A-Za-z._]+]] = fir.alloca i32 {bindc_name = "j", uniq_name = "_QFEj"}
! FIRDialect:           %[[VAL_2:[-0-9A-Za-z._]+]] = fir.undefined !fir.oss<i32>
! FIRDialect:           %[[VAL_3:[-0-9A-Za-z._]+]] = arith.constant 1 : i32
! FIRDialect:           %[[VAL_4:[-0-9A-Za-z._]+]] = arith.constant 10 : i32
! FIRDialect:           %[[VAL_5:[-0-9A-Za-z._]+]] = arith.constant 1 : i32
! FIRDialect:           %[[VAL_6:[-0-9A-Za-z._]+]] = arith.constant 1 : i64
! FIRDialect:           oss.taskloop_for lower_bound(%[[VAL_3]] : i32) upper_bound(%[[VAL_4]] : i32) step(%[[VAL_5]] : i32) loop_type(%[[VAL_6]] : i64) ind_var(%[[VAL_1]] : !fir.ref<i32>) private(%[[VAL_1]] : !fir.ref<i32>) private_type(%[[VAL_2]] : !fir.oss<i32>) {
! FIRDialect:             oss.terminator
! FIRDialect:           }
! FIRDialect:           %[[VAL_7:[-0-9A-Za-z._]+]] = fir.undefined !fir.oss<i32>
! FIRDialect:           %[[VAL_8:[-0-9A-Za-z._]+]] = fir.load %[[VAL_0]] : !fir.ref<i32>
! FIRDialect:           %[[VAL_9:[-0-9A-Za-z._]+]] = arith.constant 3 : i32
! FIRDialect:           %[[VAL_10:[-0-9A-Za-z._]+]] = arith.cmpi eq, %[[VAL_8]], %[[VAL_9]] : i32
! FIRDialect:           %[[VAL_11:[-0-9A-Za-z._]+]] = arith.constant 1 : i32
! FIRDialect:           %[[VAL_12:[-0-9A-Za-z._]+]] = arith.constant 10 : i32
! FIRDialect:           %[[VAL_13:[-0-9A-Za-z._]+]] = arith.constant 1 : i32
! FIRDialect:           %[[VAL_14:[-0-9A-Za-z._]+]] = arith.constant 1 : i64
! FIRDialect:           oss.taskloop_for lower_bound(%[[VAL_11]] : i32) upper_bound(%[[VAL_12]] : i32) step(%[[VAL_13]] : i32) loop_type(%[[VAL_14]] : i64) ind_var(%[[VAL_1]] : !fir.ref<i32>) if(%[[VAL_10]] : i1) private(%[[VAL_1]] : !fir.ref<i32>) private_type(%[[VAL_7]] : !fir.oss<i32>) {
! FIRDialect:             oss.terminator
! FIRDialect:           }
! FIRDialect:           %[[VAL_15:[-0-9A-Za-z._]+]] = fir.undefined !fir.oss<i32>
! FIRDialect:           %[[VAL_16:[-0-9A-Za-z._]+]] = fir.load %[[VAL_0]] : !fir.ref<i32>
! FIRDialect:           %[[VAL_17:[-0-9A-Za-z._]+]] = arith.constant 3 : i32
! FIRDialect:           %[[VAL_18:[-0-9A-Za-z._]+]] = arith.cmpi eq, %[[VAL_16]], %[[VAL_17]] : i32
! FIRDialect:           %[[VAL_19:[-0-9A-Za-z._]+]] = arith.constant 1 : i32
! FIRDialect:           %[[VAL_20:[-0-9A-Za-z._]+]] = arith.constant 10 : i32
! FIRDialect:           %[[VAL_21:[-0-9A-Za-z._]+]] = arith.constant 1 : i32
! FIRDialect:           %[[VAL_22:[-0-9A-Za-z._]+]] = arith.constant 1 : i64
! FIRDialect:           oss.taskloop_for lower_bound(%[[VAL_19]] : i32) upper_bound(%[[VAL_20]] : i32) step(%[[VAL_21]] : i32) loop_type(%[[VAL_22]] : i64) ind_var(%[[VAL_1]] : !fir.ref<i32>) final(%[[VAL_18]] : i1) private(%[[VAL_1]] : !fir.ref<i32>) private_type(%[[VAL_15]] : !fir.oss<i32>) {
! FIRDialect:             oss.terminator
! FIRDialect:           }
! FIRDialect:           %[[VAL_23:[-0-9A-Za-z._]+]] = fir.undefined !fir.oss<i32>
! FIRDialect:           %[[VAL_24:[-0-9A-Za-z._]+]] = arith.constant 3 : i32
! FIRDialect:           %[[VAL_25:[-0-9A-Za-z._]+]] = arith.constant 1 : i32
! FIRDialect:           %[[VAL_26:[-0-9A-Za-z._]+]] = arith.constant 10 : i32
! FIRDialect:           %[[VAL_27:[-0-9A-Za-z._]+]] = arith.constant 1 : i32
! FIRDialect:           %[[VAL_28:[-0-9A-Za-z._]+]] = arith.constant 1 : i64
! FIRDialect:           oss.taskloop_for lower_bound(%[[VAL_25]] : i32) upper_bound(%[[VAL_26]] : i32) step(%[[VAL_27]] : i32) loop_type(%[[VAL_28]] : i64) ind_var(%[[VAL_1]] : !fir.ref<i32>) cost(%[[VAL_24]] : i32) private(%[[VAL_1]] : !fir.ref<i32>) private_type(%[[VAL_23]] : !fir.oss<i32>) {
! FIRDialect:             oss.terminator
! FIRDialect:           }
! FIRDialect:           %[[VAL_29:[-0-9A-Za-z._]+]] = fir.undefined !fir.oss<i32>
! FIRDialect:           %[[VAL_30:[-0-9A-Za-z._]+]] = arith.constant 3 : i32
! FIRDialect:           %[[VAL_31:[-0-9A-Za-z._]+]] = arith.constant 1 : i32
! FIRDialect:           %[[VAL_32:[-0-9A-Za-z._]+]] = arith.constant 10 : i32
! FIRDialect:           %[[VAL_33:[-0-9A-Za-z._]+]] = arith.constant 1 : i32
! FIRDialect:           %[[VAL_34:[-0-9A-Za-z._]+]] = arith.constant 1 : i64
! FIRDialect:           oss.taskloop_for lower_bound(%[[VAL_31]] : i32) upper_bound(%[[VAL_32]] : i32) step(%[[VAL_33]] : i32) loop_type(%[[VAL_34]] : i64) ind_var(%[[VAL_1]] : !fir.ref<i32>) priority(%[[VAL_30]] : i32) private(%[[VAL_1]] : !fir.ref<i32>) private_type(%[[VAL_29]] : !fir.oss<i32>) {
! FIRDialect:             oss.terminator
! FIRDialect:           }
! FIRDialect:           %[[VAL_35:[-0-9A-Za-z._]+]] = fir.undefined !fir.oss<i32>
! FIRDialect:           %[[VAL_36:[-0-9A-Za-z._]+]] = arith.constant 1 : i32
! FIRDialect:           %[[VAL_37:[-0-9A-Za-z._]+]] = arith.constant 10 : i32
! FIRDialect:           %[[VAL_38:[-0-9A-Za-z._]+]] = arith.constant 1 : i32
! FIRDialect:           %[[VAL_39:[-0-9A-Za-z._]+]] = arith.constant 1 : i64
! FIRDialect:           oss.taskloop_for lower_bound(%[[VAL_36]] : i32) upper_bound(%[[VAL_37]] : i32) step(%[[VAL_38]] : i32) loop_type(%[[VAL_39]] : i64) ind_var(%[[VAL_1]] : !fir.ref<i32>) private(%[[VAL_1]] : !fir.ref<i32>) private_type(%[[VAL_35]] : !fir.oss<i32>) default( defshared) {
! FIRDialect:             oss.terminator
! FIRDialect:           }
! FIRDialect:           %[[VAL_40:[-0-9A-Za-z._]+]] = fir.undefined !fir.oss<i32>
! FIRDialect:           %[[VAL_41:[-0-9A-Za-z._]+]] = fir.undefined !fir.oss<i32>
! FIRDialect:           %[[VAL_42:[-0-9A-Za-z._]+]] = arith.constant 1 : i32
! FIRDialect:           %[[VAL_43:[-0-9A-Za-z._]+]] = arith.constant 10 : i32
! FIRDialect:           %[[VAL_44:[-0-9A-Za-z._]+]] = arith.constant 1 : i32
! FIRDialect:           %[[VAL_45:[-0-9A-Za-z._]+]] = arith.constant 1 : i64
! FIRDialect:           oss.taskloop_for lower_bound(%[[VAL_42]] : i32) upper_bound(%[[VAL_43]] : i32) step(%[[VAL_44]] : i32) loop_type(%[[VAL_45]] : i64) ind_var(%[[VAL_1]] : !fir.ref<i32>) private(%[[VAL_0]], %[[VAL_1]] : !fir.ref<i32>, !fir.ref<i32>) private_type(%[[VAL_40]], %[[VAL_41]] : !fir.oss<i32>, !fir.oss<i32>) {
! FIRDialect:             oss.terminator
! FIRDialect:           }
! FIRDialect:           %[[VAL_46:[-0-9A-Za-z._]+]] = fir.undefined !fir.oss<i32>
! FIRDialect:           %[[VAL_47:[-0-9A-Za-z._]+]] = fir.undefined !fir.oss<i32>
! FIRDialect:           %[[VAL_48:[-0-9A-Za-z._]+]] = arith.constant 1 : i32
! FIRDialect:           %[[VAL_49:[-0-9A-Za-z._]+]] = arith.constant 10 : i32
! FIRDialect:           %[[VAL_50:[-0-9A-Za-z._]+]] = arith.constant 1 : i32
! FIRDialect:           %[[VAL_51:[-0-9A-Za-z._]+]] = arith.constant 1 : i64
! FIRDialect:           oss.taskloop_for lower_bound(%[[VAL_48]] : i32) upper_bound(%[[VAL_49]] : i32) step(%[[VAL_50]] : i32) loop_type(%[[VAL_51]] : i64) ind_var(%[[VAL_1]] : !fir.ref<i32>) private(%[[VAL_1]] : !fir.ref<i32>) private_type(%[[VAL_46]] : !fir.oss<i32>) firstprivate(%[[VAL_0]] : !fir.ref<i32>) firstprivate_type(%[[VAL_47]] : !fir.oss<i32>) {
! FIRDialect:             oss.terminator
! FIRDialect:           }
! FIRDialect:           %[[VAL_52:[-0-9A-Za-z._]+]] = fir.undefined !fir.oss<i32>
! FIRDialect:           %[[VAL_53:[-0-9A-Za-z._]+]] = fir.undefined !fir.oss<i32>
! FIRDialect:           %[[VAL_54:[-0-9A-Za-z._]+]] = arith.constant 1 : i32
! FIRDialect:           %[[VAL_55:[-0-9A-Za-z._]+]] = arith.constant 10 : i32
! FIRDialect:           %[[VAL_56:[-0-9A-Za-z._]+]] = arith.constant 1 : i32
! FIRDialect:           %[[VAL_57:[-0-9A-Za-z._]+]] = arith.constant 1 : i64
! FIRDialect:           oss.taskloop_for lower_bound(%[[VAL_54]] : i32) upper_bound(%[[VAL_55]] : i32) step(%[[VAL_56]] : i32) loop_type(%[[VAL_57]] : i64) ind_var(%[[VAL_1]] : !fir.ref<i32>) private(%[[VAL_1]] : !fir.ref<i32>) private_type(%[[VAL_53]] : !fir.oss<i32>) shared(%[[VAL_0]] : !fir.ref<i32>) shared_type(%[[VAL_52]] : !fir.oss<i32>) {
! FIRDialect:             oss.terminator
! FIRDialect:           }
! FIRDialect:           %[[VAL_58:[-0-9A-Za-z._]+]] = fir.undefined !fir.oss<i32>
! FIRDialect:           %[[VAL_59:[-0-9A-Za-z._]+]] = arith.constant 3 : i32
! FIRDialect:           %[[VAL_60:[-0-9A-Za-z._]+]] = arith.constant 1 : i32
! FIRDialect:           %[[VAL_61:[-0-9A-Za-z._]+]] = arith.constant 10 : i32
! FIRDialect:           %[[VAL_62:[-0-9A-Za-z._]+]] = arith.constant 1 : i32
! FIRDialect:           %[[VAL_63:[-0-9A-Za-z._]+]] = arith.constant 1 : i64
! FIRDialect:           oss.taskloop_for lower_bound(%[[VAL_60]] : i32) upper_bound(%[[VAL_61]] : i32) step(%[[VAL_62]] : i32) loop_type(%[[VAL_63]] : i64) ind_var(%[[VAL_1]] : !fir.ref<i32>) private(%[[VAL_1]] : !fir.ref<i32>) private_type(%[[VAL_58]] : !fir.oss<i32>) chunksize(%[[VAL_59]] : i32) {
! FIRDialect:             oss.terminator
! FIRDialect:           }
! FIRDialect:           %[[VAL_64:[-0-9A-Za-z._]+]] = fir.undefined !fir.oss<i32>
! FIRDialect:           %[[VAL_65:[-0-9A-Za-z._]+]] = arith.constant 3 : i32
! FIRDialect:           %[[VAL_66:[-0-9A-Za-z._]+]] = arith.constant 1 : i32
! FIRDialect:           %[[VAL_67:[-0-9A-Za-z._]+]] = arith.constant 10 : i32
! FIRDialect:           %[[VAL_68:[-0-9A-Za-z._]+]] = arith.constant 1 : i32
! FIRDialect:           %[[VAL_69:[-0-9A-Za-z._]+]] = arith.constant 1 : i64
! FIRDialect:           oss.taskloop_for lower_bound(%[[VAL_66]] : i32) upper_bound(%[[VAL_67]] : i32) step(%[[VAL_68]] : i32) loop_type(%[[VAL_69]] : i64) ind_var(%[[VAL_1]] : !fir.ref<i32>) private(%[[VAL_1]] : !fir.ref<i32>) private_type(%[[VAL_64]] : !fir.oss<i32>) grainsize(%[[VAL_65]] : i32) {
! FIRDialect:             oss.terminator
! FIRDialect:           }
! FIRDialect:           return
! FIRDialect:         }

! FIRDialect-LABEL:   fir.global @_QQEnvironmentDefaults constant : !fir.ref<tuple<i32, !fir.ref<!fir.array<0xtuple<!fir.ref<i8>, !fir.ref<i8>>>>>> {
! FIRDialect:           %[[VAL_0:[-0-9A-Za-z._]+]] = fir.zero_bits !fir.ref<tuple<i32, !fir.ref<!fir.array<0xtuple<!fir.ref<i8>, !fir.ref<i8>>>>>>
! FIRDialect:           fir.has_value %[[VAL_0]] : !fir.ref<tuple<i32, !fir.ref<!fir.array<0xtuple<!fir.ref<i8>, !fir.ref<i8>>>>>>
! FIRDialect:         }

