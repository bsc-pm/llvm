! NOTE: Assertions have been autogenerated by /home/rpenacob/llvm-mono/mlir/utils/generate-test-checks.py
! Test checks directives are taken into account as a lexicalSuccessors.
! In this case STOP must have the OmpSsConstruct as a lexicalSuccessor
! to marks it as a start new block evaluation.

! RUN: bbc -fompss-2 -emit-fir %s -o - | FileCheck %s --check-prefix=FIRDialect

PROGRAM P
    IMPLICIT NONE
    INTEGER ::X

    !$OSS TASK
    X = 888
    !$OSS END TASK

    IF (X /= 1) STOP 1

!    X = 999

    !$OSS TASK
    X = 777
    !$OSS END TASK

END PROGRAM P

! FIRDialect-LABEL:   func.func @_QQmain() attributes {fir.bindc_name = "p"} {
! FIRDialect:           %[[VAL_0:[-0-9A-Za-z._]+]] = arith.constant false
! FIRDialect:           %[[VAL_1:[-0-9A-Za-z._]+]] = arith.constant 1 : i32
! FIRDialect:           %[[VAL_2:[-0-9A-Za-z._]+]] = fir.alloca i32 {bindc_name = "x", uniq_name = "_QFEx"}
! FIRDialect:           %[[VAL_3:[-0-9A-Za-z._]+]] = fir.declare %[[VAL_2]] {uniq_name = "_QFEx"} : (!fir.ref<i32>) -> !fir.ref<i32>
! FIRDialect:           %[[VAL_4:[-0-9A-Za-z._]+]] = fir.undefined !fir.oss<i32>
! FIRDialect:           oss.task firstprivate(%[[VAL_3]], %[[VAL_3]] : !fir.ref<i32>, !fir.ref<i32>) firstprivate_type(%[[VAL_4]], %[[VAL_4]] : !fir.oss<i32>, !fir.oss<i32>) {
! FIRDialect:             %[[VAL_5:[-0-9A-Za-z._]+]] = arith.constant 888 : i32
! FIRDialect:             fir.store %[[VAL_5]] to %[[VAL_3]] : !fir.ref<i32>
! FIRDialect:             oss.terminator
! FIRDialect:           }
! FIRDialect:           %[[VAL_6:[-0-9A-Za-z._]+]] = fir.load %[[VAL_3]] : !fir.ref<i32>
! FIRDialect:           %[[VAL_7:[-0-9A-Za-z._]+]] = arith.cmpi ne, %[[VAL_6]], %[[VAL_1]] : i32
! FIRDialect:           cf.cond_br %[[VAL_7]], ^bb1, ^bb2
! FIRDialect:         ^bb1:
! FIRDialect:           %[[VAL_8:[-0-9A-Za-z._]+]] = fir.call @_FortranAStopStatement(%[[VAL_1]], %[[VAL_0]], %[[VAL_0]]) fastmath<contract> : (i32, i1, i1) -> none
! FIRDialect:           fir.unreachable
! FIRDialect:         ^bb2:
! FIRDialect:           oss.task firstprivate(%[[VAL_3]], %[[VAL_3]] : !fir.ref<i32>, !fir.ref<i32>) firstprivate_type(%[[VAL_4]], %[[VAL_4]] : !fir.oss<i32>, !fir.oss<i32>) {
! FIRDialect:             %[[VAL_9:[-0-9A-Za-z._]+]] = arith.constant 777 : i32
! FIRDialect:             fir.store %[[VAL_9]] to %[[VAL_3]] : !fir.ref<i32>
! FIRDialect:             oss.terminator
! FIRDialect:           }
! FIRDialect:           return
! FIRDialect:         }
! FIRDialect:         func.func private @_FortranAStopStatement(i32, i1, i1) -> none attributes {fir.runtime}

! FIRDialect-LABEL:   fir.global @_QQEnvironmentDefaults constant : !fir.ref<tuple<i32, !fir.ref<!fir.array<0xtuple<!fir.ref<i8>, !fir.ref<i8>>>>>> {
! FIRDialect:           %[[VAL_0:[-0-9A-Za-z._]+]] = fir.zero_bits !fir.ref<tuple<i32, !fir.ref<!fir.array<0xtuple<!fir.ref<i8>, !fir.ref<i8>>>>>>
! FIRDialect:           fir.has_value %[[VAL_0]] : !fir.ref<tuple<i32, !fir.ref<!fir.array<0xtuple<!fir.ref<i8>, !fir.ref<i8>>>>>>
! FIRDialect:         }

